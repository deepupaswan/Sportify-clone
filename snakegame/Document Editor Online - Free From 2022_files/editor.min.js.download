!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&"object"==typeof module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(f,e){f.fn.resizableSafe||(f.fn.resizableSafe=function(c){var u={handleSelector:null,resizeWidth:!0,resizeHeight:!0,resizeWidthFrom:"right",resizeHeightFrom:"bottom",onDragStart:null,onDragEnd:null,onDrag:null,touchActionNone:!0,instanceId:null};return"object"==typeof c&&(u=f.extend(u,c)),this.each(function(){var n,t,a=f.extend({},u);a.instanceId||(a.instanceId="rsz_"+(new Date).getTime());var e,r=f(this);if("destroy"===c)return(a=r.data("resizable"))?((e=d(a.handleSelector,r)).off("mousedown."+a.instanceId+" touchstart."+a.instanceId),a.touchActionNone&&e.css("touch-action",""),void r.removeClass("resizable")):void 0;function o(e){e.stopPropagation(),e.preventDefault()}function i(e){var t=l(e),o="left"===a.resizeWidthFrom?n.width-t.x+n.x:n.width+t.x-n.x,t="top"===a.resizeHeightFrom?n.height-t.y+n.y:n.height+t.y-n.y;a.onDrag&&!1===a.onDrag(e,r,o,t,a)||(a.resizeHeight&&r.height(t),a.resizeWidth&&r.width(o))}function s(e){return e.stopPropagation(),e.preventDefault(),f(document).off("mousemove."+a.instanceId),f(document).off("mouseup."+a.instanceId),(window.Touch||navigator.maxTouchPoints)&&(f(document).off("touchmove."+a.instanceId),f(document).off("touchend."+a.instanceId)),f(document).off("selectstart."+a.instanceId,o),r.css("transition",t),f("iframe").css("pointer-events","auto"),a.onDragEnd&&a.onDragEnd(e,r,a),!1}function l(e){var t={x:0,y:0,width:0,height:0};if("number"==typeof e.clientX)t.x=e.clientX,t.y=e.clientY;else{if(!e.originalEvent.touches)return null;t.x=e.originalEvent.touches[0].clientX,t.y=e.originalEvent.touches[0].clientY}return t}function d(e,t){return e&&">"===e.trim()[0]?(e=e.trim().replace(/^>\s*/,""),t.find(e)):e?t.parent().find(e):t}r.data("resizable",a),e=d(a.handleSelector,r),a.touchActionNone&&e.css("touch-action","none"),r.addClass("resizable"),e.on("mousedown."+a.instanceId+" touchstart."+a.instanceId,function(e){e.preventDefault&&e.preventDefault();if((n=l(e)).width=parseInt(r.width(),10),n.height=parseInt(r.height(),10),t=r.css("transition"),r.css("transition","none"),a.onDragStart&&!1===a.onDragStart(e,r,a))return;f(document).on("mousemove."+a.instanceId,i),f(document).on("mouseup."+a.instanceId,s),(window.Touch||navigator.maxTouchPoints)&&(f(document).on("touchmove."+a.instanceId,i),f(document).on("touchend."+a.instanceId,s));f(document).on("selectstart."+a.instanceId,o),f("iframe").css("pointer-events","none")})})},f.fn.resizable||(f.fn.resizable=f.fn.resizableSafe))});var THROTTLE_TIMEOUT=5e3,throttler=null,gaEvent=function(e,t){};function gaEventSocial(t,o,n){if(o=o||"Social","ga"in window)try{const a=window.ga.getAll()[0];if(void 0!==a){let e={eventCategory:o,eventAction:t};void 0!==n&&(e.eventLabel=n),a.send("event",e)}}catch(e){}}function shareApp(t,e=!1){if(-1!==["facebook","twitter","linkedin","vk","odnoklassniki","cloud","github","feedback","otherapp","bookmark","zapier","clipboard","link"].indexOf(t)){var n=-1!==window.location.hostname.indexOf("localhost")?"products.aspose.app":window.location.hostname,r=window.location.pathname,i=encodeURI("https://"+n+r),s=encodeURI("https://"+n+"/words/common/img/howto.png"),l=document.title.replace("&","and"),r="cloud"!==t?t.charAt(0).toUpperCase()+t.slice(1):"WordsCloud",n="undefined"!=typeof InstallTrigger;e?gaEventSocial(r,"SocialNPS",$("#nps-step-6 > .nps-step__row")[0].getAttribute("data-nps")):gaEventSocial(r);var d=e=>{let t=t||window.event;t=t.target||t.srcElement,"A"!==t.tagName&&(a=document.createElement("a"),a.href=e,a.setAttribute("target","_blank"),a.click())};if("facebook"!==t||n)if(-1!==["facebook","twitter","linkedin","vk","odnoklassniki"].indexOf(t)){let e;switch(t){case"facebook":e=`https://www.facebook.com/sharer/sharer.php?u=${i}&picture=${s}&popup=true&app_id=813346076044703`;break;case"twitter":e=`https://twitter.com/intent/tweet?text=${encodeURI(l)}&url=${i}&hashtags=${o.AppName}`;break;case"linkedin":e="https://www.linkedin.com/sharing/share-offsite/?url="+i;break;case"vk":e="http://vk.com/share.php?url="+i,l&&(e+="&title="+encodeURIComponent(l)),s&&(e+="&image="+s),e+="&noparse=true";break;case"odnoklassniki":e="https://connect.ok.ru/offer?url="+i}r=(window.innerWidth-560)/2,n=(window.innerHeight-520)/2;window.open(e,"Social",`width=560,height=520,left=${r},top=${n},menubar=no,toolbar=no,status=no,resizable=yes,scrollbars=no`)}else switch(t){case"link":case"clipboard":var c=document.URL.replace("#","");navigator.clipboard.writeText(c),$("#nps-step-6").find(".fa-clipboard").removeClass("fa-clipboard").removeClass("fa-link").addClass("fa-check-circle");break;case"otherapp":break;case"cloud":d("https://products.aspose.cloud/words/family");break;case"github":d("https://github.com/aspose-words/Aspose.Words-for-.NET");break;case"zapier":d("https://docs.aspose.cloud/words/plugins/zapier/")}else FB.ui({display:"popup",method:"share",href:i},function(e){})}}jQuery.trumbowyg={langs:{en:{viewHTML:"View HTML",undo:"Undo",redo:"Redo",formatting:"Formatting",p:"Paragraph",blockquote:"Quote",code:"Code",header:"Header",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",underline:"Underline",strong:"Strong",em:"Emphasis",del:"Deleted",superscript:"Superscript",subscript:"Subscript",unorderedList:"Unordered list",orderedList:"Ordered list",insertImage:"Insert Image",link:"Link",createLink:"Insert link",unlink:"Remove link",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",horizontalRule:"Insert horizontal rule",removeformat:"Remove format",fullscreen:"Fullscreen",close:"Close",submit:"Confirm",reset:"Cancel",required:"Required",description:"Description",title:"Title",text:"Text",target:"Target",width:"Width"}},plugins:{},svgPath:null,hideButtonTexts:null},Object.defineProperty(jQuery.trumbowyg,"defaultOptions",{value:{lang:"en",fixedBtnPane:!1,fixedFullWidth:!1,autogrow:!1,autogrowOnEnter:!1,imageWidthModalEdit:!1,prefix:"trumbowyg-",semantic:!0,semanticKeepAttributes:!1,resetCss:!1,removeformatPasted:!1,tabToIndent:!1,tagsToRemove:[],tagsToKeep:["hr","img","embed","iframe","input"],btns:[["viewHTML"],["undo","redo"],["formatting"],["strong","em","del"],["superscript","subscript"],["link"],["insertImage"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["horizontalRule"],["removeformat"],["fullscreen"]],btnsDef:{},changeActiveDropdownIcon:!1,inlineElementsSelector:"a,abbr,acronym,b,caption,cite,code,col,dfn,dir,dt,dd,em,font,hr,i,kbd,li,q,span,strikeout,strong,sub,sup,u",pasteHandlers:[],plugins:{},urlProtocol:!1,minimalLinks:!1},writable:!1,enumerable:!0,configurable:!1}),function(f,p,g,m){"use strict";var d="tbwconfirm",c="tbwcancel";m.fn.trumbowyg=function(e,t){var o="trumbowyg";if(e===Object(e)||!e)return this.each(function(){m(this).data(o)||m(this).data(o,new a(this,e))});if(1===this.length)try{var n=m(this).data(o);switch(e){case"execCmd":return n.execCmd(t.cmd,t.param,t.forceCss);case"openModal":return n.openModal(t.title,t.content);case"closeModal":return n.closeModal();case"openModalInsert":return n.openModalInsert(t.title,t.fields,t.callback);case"saveRange":return n.saveRange();case"getRange":return n.range;case"getRangeText":return n.getRangeText();case"restoreRange":return n.restoreRange();case"enable":return n.setDisabled(!1);case"disable":return n.setDisabled(!0);case"toggle":return n.toggle();case"destroy":return n.destroy();case"empty":return n.empty();case"html":return n.html(t)}}catch(e){}return!1};var a=function(e,t){var o=this,n="trumbowyg-icons",a=m.trumbowyg;o.doc=e.ownerDocument||g,o.$ta=m(e),o.$c=m(e),null!=(t=t||{}).lang||null!=a.langs[t.lang]?o.lang=m.extend(!0,{},a.langs.en,a.langs[t.lang]):o.lang=a.langs.en,o.hideButtonTexts=(null!=a.hideButtonTexts?a:t).hideButtonTexts;var r=(null!=a.svgPath?a:t).svgPath;if(o.hasSvg=!1!==r,o.svgPath=o.doc.querySelector("base")?p.location.href.split("#")[0]:"",0===m("#"+n,o.doc).length&&!1!==r){if(null==r){for(var i=g.getElementsByTagName("script"),s=0;s<i.length;s+=1){var l=i[s].src,d=l.match("trumbowyg(.min)?.js");null!=d&&(r=l.substring(0,l.indexOf(d[0]))+"ui/icons.svg")}null==r&&console.warn("You must define svgPath: https://goo.gl/CfTY9U")}var c=o.doc.createElement("div");c.id=n,o.doc.body.insertBefore(c,o.doc.body.childNodes[0]),m.ajax({async:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"xml",crossDomain:!0,url:r,data:null,beforeSend:null,complete:null,success:function(e){c.innerHTML=(new XMLSerializer).serializeToString(e.documentElement)}})}var u=o.lang.header,n=function(){return(p.chrome||p.Intl&&Intl.v8BreakIterator)&&"CSS"in p};o.btnsDef={viewHTML:{fn:"toggle",class:"trumbowyg-not-disable"},undo:{isSupported:n,key:"Z"},redo:{isSupported:n,key:"Y"},p:{fn:"formatBlock"},blockquote:{fn:"formatBlock"},h1:{fn:"formatBlock",title:u+" 1"},h2:{fn:"formatBlock",title:u+" 2"},h3:{fn:"formatBlock",title:u+" 3"},h4:{fn:"formatBlock",title:u+" 4"},h5:{fn:"formatBlock",title:u+" 5"},h6:{fn:"formatBlock",title:u+" 6"},subscript:{tag:"sub"},superscript:{tag:"sup"},bold:{key:"B",tag:"b"},italic:{key:"I",tag:"i"},underline:{tag:"u"},strikethrough:{tag:"strike"},strong:{fn:"bold",key:"B"},em:{fn:"italic",key:"I"},del:{fn:"strikethrough"},createLink:{key:"K",tag:"a"},unlink:{},insertImage:{},justifyLeft:{tag:"left",forceCss:!0},justifyCenter:{tag:"center",forceCss:!0},justifyRight:{tag:"right",forceCss:!0},justifyFull:{tag:"justify",forceCss:!0},unorderedList:{fn:"insertUnorderedList",tag:"ul"},orderedList:{fn:"insertOrderedList",tag:"ol"},horizontalRule:{fn:"insertHorizontalRule"},removeformat:{},fullscreen:{class:"trumbowyg-not-disable"},close:{fn:"destroy",class:"trumbowyg-not-disable"},formatting:{dropdown:["p","blockquote","h1","h2","h3","h4"],ico:"p"},link:{dropdown:["createLink","unlink"]}},o.o=m.extend(!0,{},a.defaultOptions,t),o.o.hasOwnProperty("imgDblClickHandler")||(o.o.imgDblClickHandler=o.getDefaultImgDblClickHandler()),o.urlPrefix=o.setupUrlPrefix(),o.disabled=o.o.disabled||"TEXTAREA"===e.nodeName&&e.disabled,t.btns?o.o.btns=t.btns:o.o.semantic||(o.o.btns[3]=["bold","italic","underline","strikethrough"]),m.each(o.o.btnsDef,function(e,t){o.addBtnDef(e,t)}),o.eventNamespace="trumbowyg-event",o.keys=[],o.tagToButton={},o.tagHandlers=[],o.pasteHandlers=[].concat(o.o.pasteHandlers),o.isIE=-1!==f.userAgent.indexOf("MSIE")||-1!==f.appVersion.indexOf("Trident/"),o.isMac=-1!==f.platform.toUpperCase().indexOf("MAC"),o.init()};a.prototype={DEFAULT_SEMANTIC_MAP:{b:"strong",i:"em",s:"del",strike:"del",div:"p"},init:function(){var e=this;e.height=e.$ta.height(),e.initPlugins();try{e.doc.execCommand("enableObjectResizing",!1,!1),e.doc.execCommand("defaultParagraphSeparator",!1,"p")}catch(e){}e.buildEditor(),e.buildBtnPane(),e.fixedBtnPaneEvents(),e.buildOverlay(),setTimeout(function(){e.disabled&&e.setDisabled(!0),e.$c.trigger("tbwinit")})},addBtnDef:function(e,t){this.btnsDef[e]=m.extend(t,this.btnsDef[e]||{})},setupUrlPrefix:function(){var e=this.o.urlProtocol;if(e)return"string"!=typeof e?"https://":e.replace("://","")+"://"},buildEditor:function(){var n=this,t=n.o.prefix,e="";n.$box=m("<div/>",{class:t+"box "+t+"editor-visible "+t+n.o.lang+" trumbowyg"}),n.isTextarea=n.$ta.is("textarea"),n.isTextarea?(e=n.$ta.val(),n.$ed=m("<div/>"),n.$box.insertAfter(n.$ta).append(n.$ed,n.$ta)):(n.$ed=n.$ta,e=n.$ed.html(),n.$ta=m("<textarea/>",{name:n.$ta.attr("id"),height:n.height}).val(e),n.$box.insertAfter(n.$ed).append(n.$ta,n.$ed),n.syncCode()),n.$ta.addClass(t+"textarea").attr("tabindex",-1),n.$ed.addClass(t+"editor").attr({contenteditable:!0,dir:n.lang._dir||"ltr"}).html(e),n.o.tabindex&&n.$ed.attr("tabindex",n.o.tabindex),n.$c.is("[placeholder]")&&n.$ed.attr("placeholder",n.$c.attr("placeholder")),n.$c.is("[spellcheck]")&&n.$ed.attr("spellcheck",n.$c.attr("spellcheck")),n.o.resetCss&&n.$ed.addClass(t+"reset-css"),n.o.autogrow||n.$ta.add(n.$ed).css({height:n.height}),n.semanticCode(),n.o.autogrowOnEnter&&n.$ed.addClass(t+"autogrow-on-enter");var o,a=!1,r=!1;n.$ed.on("dblclick","img",n.o.imgDblClickHandler).on("keydown",function(e){if(!e.ctrlKey&&!e.metaKey||e.altKey){if(n.o.tabToIndent&&"Tab"===e.key)try{return e.shiftKey?n.execCmd("outdent",!0,null):n.execCmd("indent",!0,null),!1}catch(e){}}else{a=!0;e=n.keys[String.fromCharCode(e.which).toUpperCase()];try{return n.execCmd(e.fn,e.param),!1}catch(e){}}}).on("compositionstart compositionupdate",function(){r=!0}).on("keyup compositionend",function(e){if("compositionend"===e.type)r=!1;else if(r)return;var t=e.which;37<=t&&t<=40||(!e.ctrlKey&&!e.metaKey||89!==t&&90!==t?a||17===t?void 0===e.which&&n.semanticCode(!1,!1,!0):(n.isIE&&e.type,n.$c.trigger("tbwchange")):(n.semanticCode(!1,!0),n.$c.trigger("tbwchange")),setTimeout(function(){a=!1},50))}).on("mouseup keydown keyup",function(e){(e.ctrlKey||e.metaKey)&&!e.altKey||setTimeout(function(){a=!1},50),clearTimeout(o),o=setTimeout(function(){n.updateButtonPaneStatus()},50)}).on("focus blur",function(e){n.$c.trigger("tbw"+e.type),"blur"===e.type&&n.clearButtonPaneStatus(),n.o.autogrowOnEnter&&(n.autogrowOnEnterDontClose||("focus"===e.type?(n.autogrowOnEnterWasFocused=!0,n.autogrowEditorOnEnter()):n.o.autogrow||(n.$ed.css({height:n.$ed.css("min-height")}),n.$c.trigger("tbwresize"))))}).on("cut drop",function(){setTimeout(function(){n.semanticCode(!1,!0),n.$c.trigger("tbwchange")},0)}).on("paste",function(o){if(n.o.removeformatPasted){o.preventDefault(),p.getSelection&&p.getSelection().deleteFromDocument&&p.getSelection().deleteFromDocument();try{var t=p.clipboardData.getData("Text");try{n.doc.selection.createRange().pasteHTML(t)}catch(e){n.doc.getSelection().getRangeAt(0).insertNode(n.doc.createTextNode(t))}n.$c.trigger("tbwchange",o)}catch(e){n.execCmd("insertText",(o.originalEvent||o).clipboardData.getData("text/plain"))}}m.each(n.pasteHandlers,function(e,t){t(o)}),setTimeout(function(){n.semanticCode(!1,!0),n.$c.trigger("tbwpaste",o),n.$c.trigger("tbwchange")},0)}),n.$ta.on("keyup",function(){n.$c.trigger("tbwchange")}).on("paste",function(){setTimeout(function(){n.$c.trigger("tbwchange")},0)}),n.$box.on("keydown",function(e){if(27===e.which&&1===m("."+t+"modal-box",n.$box).length)return n.closeModal(),!1})},autogrowEditorOnEnter:function(){var e=this;e.$ed.removeClass("autogrow-on-enter");var t=e.$ed[0].clientHeight;e.$ed.height("auto");var o=e.$ed[0].scrollHeight;e.$ed.addClass("autogrow-on-enter"),t!==o&&(e.$ed.height(t),setTimeout(function(){e.$ed.css({height:o}),e.$c.trigger("tbwresize")},0))},buildBtnPane:function(){var n=this,a=n.o.prefix,r=n.$btnPane=m("<div/>",{class:a+"button-pane"});m.each(n.o.btns,function(e,t){m.isArray(t)||(t=[t]);var o=m("<div/>",{class:a+"button-group "+(0<=t.indexOf("fullscreen")?a+"right":"")});m.each(t,function(e,t){try{n.isSupportedBtn(t)&&o.append(n.buildBtn(t))}catch(e){}}),0<o.html().trim().length&&r.append(o)}),n.$box.prepend(r)},buildBtn:function(e){var o,n=this,t=n.o.prefix,a=n.btnsDef[e],r=a.dropdown,i=null==a.hasIcon||a.hasIcon,s=n.lang[e]||e,l=m("<button/>",{type:"button",class:t+e+"-button "+(a.class||"")+(i?"":" "+t+"textual-button"),html:n.hasSvg&&i?'<svg><use xlink:href="'+n.svgPath+"#"+t+(a.ico||e).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>':n.hideButtonTexts?"":a.text||a.title||n.lang[e]||e,title:(a.title||a.text||s)+(a.key?" ("+(n.isMac?"Cmd":"Ctrl")+" + "+a.key+")":""),tabindex:-1,mousedown:function(){return gaEvent("Click: "+e),r&&!m("."+e+"-"+t+"dropdown",n.$box).is(":hidden")||m("body",n.doc).trigger("mousedown"),(!n.$btnPane.hasClass(t+"disable")&&!n.$box.hasClass(t+"disabled")||m(this).hasClass(t+"active")||m(this).hasClass(t+"not-disable"))&&n.execCmd((!r?a.fn:"dropdown")||e,a.param||e,a.forceCss),!1}});return r?(l.addClass(t+"open-dropdown"),(s={class:(i=t+"dropdown")+"-"+e+" "+i+" "+t+"fixed-top "+(a.dropdownClass||"")})["data-"+i]=e,o=m("<div/>",s),m.each(r,function(e,t){n.btnsDef[t]&&n.isSupportedBtn(t)&&o.append(n.buildSubBtn(t))}),n.$box.append(o.hide())):a.key&&(n.keys[a.key]={fn:a.fn||e,param:a.param||e}),r||(n.tagToButton[(a.tag||e).toLowerCase()]=e),l},buildSubBtn:function(e){var t=this,o=t.o.prefix,n=t.btnsDef[e],a=null==n.hasIcon||n.hasIcon;return n.key&&(t.keys[n.key]={fn:n.fn||e,param:n.param||e}),t.tagToButton[(n.tag||e).toLowerCase()]=e,m("<button/>",{type:"button",class:o+e+"-dropdown-button "+(n.class||"")+(n.ico?" "+o+n.ico+"-button":""),html:t.hasSvg&&a?'<svg><use xlink:href="'+t.svgPath+"#"+o+(n.ico||e).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>'+(n.text||n.title||t.lang[e]||e):n.text||n.title||t.lang[e]||e,title:n.key?"("+(t.isMac?"Cmd":"Ctrl")+" + "+n.key+")":null,style:n.style||null,mousedown:function(){return m("body",t.doc).trigger("mousedown"),t.execCmd(n.fn||e,n.param||e,n.forceCss),!1}})},isSupportedBtn:function(e){try{return this.btnsDef[e].isSupported()}catch(e){}return!0},buildOverlay:function(){return this.$overlay=m("<div/>",{class:this.o.prefix+"overlay"}).appendTo(this.$box),this.$overlay},showOverlay:function(){m(p).trigger("scroll"),this.$overlay.fadeIn(200),this.$box.addClass(this.o.prefix+"box-blur")},hideOverlay:function(){this.$overlay.fadeOut(50),this.$box.removeClass(this.o.prefix+"box-blur")},fixedBtnPaneEvents:function(){var a=this,r=a.o.fixedFullWidth,i=a.$box;a.o.fixedBtnPane&&(a.isFixed=!1,m(p).on("scroll."+a.eventNamespace+" resize."+a.eventNamespace,function(){var e,t,o,n;i&&(a.syncCode(),e=m(p).scrollTop(),t=i.offset().top+1,n=(o=a.$btnPane).outerHeight()-2,0<e-t&&e-t-a.height<0?(a.isFixed||(a.isFixed=!0,o.css({position:"fixed",top:"50px",left:r?0:"auto",zIndex:7}),a.$box.css({paddingTop:o.height()})),o.css({width:r?"100%":i.width()-1}),m("."+a.o.prefix+"fixed-top",i).css({position:r?"fixed":"absolute",top:r?n:e-t+n,zIndex:15})):a.isFixed&&(a.isFixed=!1,o.removeAttr("style"),a.$box.css({paddingTop:0}),m("."+a.o.prefix+"fixed-top",i).css({position:"absolute",top:n})))}))},setDisabled:function(e){var t=this,o=t.o.prefix;(t.disabled=e)?t.$ta.attr("disabled",!0):t.$ta.removeAttr("disabled"),t.$box.toggleClass(o+"disabled",e),t.$ed.attr("contenteditable",!e)},destroy:function(){var e=this,t=e.o.prefix;e.isTextarea?e.$box.after(e.$ta.css({height:""}).val(e.html()).removeClass(t+"textarea").show()):e.$box.after(e.$ed.css({height:""}).removeClass(t+"editor").removeAttr("contenteditable").removeAttr("dir").html(e.html()).show()),e.$ed.off("dblclick","img"),e.destroyPlugins(),e.$box.remove(),e.$c.removeData("trumbowyg"),m("body").removeClass(t+"body-fullscreen"),e.$c.trigger("tbwclose"),m(p).off("scroll."+e.eventNamespace+" resize."+e.eventNamespace)},empty:function(){this.$ta.val(""),this.syncCode(!0)},toggle:function(){var e=this,t=e.o.prefix;e.o.autogrowOnEnter&&(e.autogrowOnEnterDontClose=!e.$box.hasClass(t+"editor-hidden")),e.semanticCode(!1,!0),setTimeout(function(){e.doc.activeElement.blur(),e.$box.toggleClass(t+"editor-hidden "+t+"editor-visible"),e.$btnPane.toggleClass(t+"disable"),m("."+t+"viewHTML-button",e.$btnPane).toggleClass(t+"active"),e.$box.hasClass(t+"editor-visible")?e.$ta.attr("tabindex",-1):e.$ta.removeAttr("tabindex"),e.o.autogrowOnEnter&&!e.autogrowOnEnterDontClose&&e.autogrowEditorOnEnter()},0)},dropdown:function(e){var t=this,o=m("body",t.doc),n=t.o.prefix,a=m("[data-"+n+"dropdown="+e+"]",t.$box),r=m("."+n+e+"-button",t.$btnPane),e=a.is(":hidden");o.trigger("mousedown"),e&&(e=r.offset().left,r.addClass(n+"active"),a.css({position:"absolute",top:r.offset().top-t.$btnPane.offset().top+r.outerHeight(),left:t.o.fixedFullWidth&&t.isFixed?e:e-t.$btnPane.offset().left}).show(),m(p).trigger("scroll"),o.on("mousedown."+t.eventNamespace,function(e){a.is(e.target)||(m("."+n+"dropdown",t.$box).hide(),m("."+n+"active",t.$btnPane).removeClass(n+"active"),o.off("mousedown."+t.eventNamespace))}))},html:function(e){var t=this;return null!=e?(t.$ta.val(e),t.syncCode(!0),t.$c.trigger("tbwchange"),t):t.$ta.val()},syncTextarea:function(){var e=this;e.$ta.val(0<e.$ed.text().trim().length||0<e.$ed.find(e.o.tagsToKeep.join(",")).length?e.$ed.html():"")},syncCode:function(e){var t,o=this;!e&&o.$ed.is(":visible")?o.syncTextarea():(t=m("<div>").html(o.$ta.val()),t=m("<div>").append(t),m(o.o.tagsToRemove.join(","),t).remove(),o.$ed.html(t.contents().html())),o.o.autogrow&&(o.height=o.$ed.height(),o.height!==o.$ta.css("height")&&(o.$ta.css({height:o.height}),o.$c.trigger("tbwresize"))),o.o.autogrowOnEnter&&(o.$ed.height("auto"),(t=o.autogrowOnEnterWasFocused?o.$ed[0].scrollHeight:o.$ed.css("min-height"))!==o.$ta.css("height")&&(o.$ed.css({height:t}),o.$c.trigger("tbwresize")))},semanticCode:function(e,t,o){var n,a,r,i=this;i.saveRange(),i.syncCode(e),i.o.semantic&&(i.semanticTag("b",i.o.semanticKeepAttributes),i.semanticTag("i",i.o.semanticKeepAttributes),i.semanticTag("s",i.o.semanticKeepAttributes),i.semanticTag("strike",i.o.semanticKeepAttributes),t&&(n=i.o.inlineElementsSelector,a=":not("+n+")",i.$ed.contents().filter(function(){return 3===this.nodeType&&0<this.nodeValue.trim().length}).wrap("<span data-tbw/>"),(r=function(e){var t;0!==e.length&&(e=(t=e.nextUntil(a).addBack().wrapAll("<p/>").parent()).nextAll(n).first(),t.next("br").remove(),r(e))})(i.$ed.children(n).first()),i.semanticTag("div",!0),m("[data-tbw]",i.$ed).contents().unwrap(),i.$ed.find("p:empty").remove()),o||i.restoreRange(),i.syncTextarea())},semanticTag:function(e,t){var o;if(null!=this.o.semantic&&"object"==typeof this.o.semantic&&this.o.semantic.hasOwnProperty(e))o=this.o.semantic[e];else{if(!0!==this.o.semantic||!this.DEFAULT_SEMANTIC_MAP.hasOwnProperty(e))return;o=this.DEFAULT_SEMANTIC_MAP[e]}m(e,this.$ed).each(function(){var e=m(this);if(0===e.contents().length)return!1;e.wrap("<"+o+"/>"),t&&m.each(e.prop("attributes"),function(){e.parent().attr(this.name,this.value)}),e.contents().unwrap()})},createLink:function(){for(var e,t,o,n,a=this,r=a.doc.getSelection(),i=r.focusNode,s=(new XMLSerializer).serializeToString(r.getRangeAt(0).cloneContents());["A","DIV"].indexOf(i.nodeName)<0;)i=i.parentNode;i&&"A"===i.nodeName&&(s=(n=m(i)).text(),o=n.attr("href"),a.o.minimalLinks||(e=n.attr("title"),t=n.attr("target")),(n=a.doc.createRange()).selectNode(i),r.removeAllRanges(),r.addRange(n)),a.saveRange();s={url:{label:"URL",required:!0,value:o},text:{label:a.lang.text,value:s}};a.o.minimalLinks||Object.assign(s,{title:{label:a.lang.title,value:e},target:{label:a.lang.target,value:t}}),a.openModalInsert(a.lang.createLink,s,function(e){var t=a.prependUrlPrefix(e.url);if(!t.length)return!1;t=m(['<a href="',t,'">',e.text||e.url,"</a>"].join(""));return a.o.minimalLinks||(0<e.title.length&&t.attr("title",e.title),0<e.target.length&&t.attr("target",e.target)),a.range.deleteContents(),a.range.insertNode(t[0]),a.syncCode(),a.$c.trigger("tbwchange"),!0})},prependUrlPrefix:function(e){if(!this.urlPrefix)return e;if(/^([a-z][-+.a-z0-9]*:|\/|#)/i.test(e))return e;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?"mailto:"+e:this.urlPrefix+e},unlink:function(){var e,t=this.doc.getSelection(),o=t.focusNode;if(t.isCollapsed){for(;["A","DIV"].indexOf(o.nodeName)<0;)o=o.parentNode;o&&"A"===o.nodeName&&((e=this.doc.createRange()).selectNode(o),t.removeAllRanges(),t.addRange(e))}this.execCmd("unlink",void 0,void 0,!0)},insertImage:function(){var o=this;o.saveRange();var e={url:{label:"URL",required:!0},alt:{label:o.lang.description,value:o.getRangeText()}};o.o.imageWidthModalEdit&&(e.width={}),o.openModalInsert(o.lang.insertImage,e,function(e){o.execCmd("insertImage",e.url,!1,!0);var t=m('img[src="'+e.url+'"]:not([alt])',o.$box);return t.attr("alt",e.alt),o.o.imageWidthModalEdit&&t.attr({width:e.width}),o.syncCode(),o.$c.trigger("tbwchange"),!0})},fullscreen:function(){var e=this,t=e.o.prefix,o=t+"fullscreen",n=o+"-placeholder",a=e.$box.outerHeight();e.$box.toggleClass(o),(o=e.$box.hasClass(o))?e.$box.before(m("<div/>",{class:n}).css({height:a})):m("."+n).remove(),m("body").toggleClass(t+"body-fullscreen",o),m(p).trigger("scroll"),e.$c.trigger("tbw"+(o?"open":"close")+"fullscreen")},execCmd:function(t,o,e,n){var a=this;n=!!n||"","dropdown"!==t&&a.$ed.focus();try{a.doc.execCommand("styleWithCSS",!1,e||!1)}catch(e){}try{a[t+n](o)}catch(e){try{t(o)}catch(e){"insertHorizontalRule"===t?o=void 0:"formatBlock"===t&&a.isIE&&(o="<"+o+">"),a.doc.execCommand(t,!1,o)}"dropdown"!==t&&(a.updateButtonPaneStatus(),a.$c.trigger("tbwchange"))}},openModal:function(e,t){var o=this,n=o.o.prefix;if(0<m("."+n+"modal-box",o.$box).length)return!1;o.o.autogrowOnEnter&&(o.autogrowOnEnterDontClose=!0),o.saveRange(),o.showOverlay(),o.$btnPane.addClass(n+"disable");var a=m("<div/>",{class:n+"modal "+n+"fixed-top"}).css({top:o.$box.offset().top+o.$btnPane.height(),zIndex:99999}).appendTo(m(o.doc.body));o.$overlay.one("click",function(){return a.trigger(c),!1});t=m("<form/>",{action:"",html:t}).on("submit",function(){return a.trigger(d),!1}).on("reset",function(){return a.trigger(c),!1}).on("submit reset",function(){o.o.autogrowOnEnter&&(o.autogrowOnEnterDontClose=!1)}),t=m("<div/>",{class:n+"modal-box",html:t}).css({top:"-"+o.$btnPane.outerHeight(),opacity:0}).appendTo(a).animate({top:0,opacity:1},100);return m("<span/>",{text:e,class:n+"modal-title"}).prependTo(t),a.height(t.outerHeight()+10),m("input:first",t).focus(),o.buildModalBtn("submit",t),o.buildModalBtn("reset",t),m(p).trigger("scroll"),a},buildModalBtn:function(e,t){var o=this.o.prefix;return m("<button/>",{class:o+"modal-button "+o+"modal-"+e,type:e,text:this.lang[e]||e}).appendTo(m("form",t))},closeModal:function(){var e=this,t=e.o.prefix;e.$btnPane.removeClass(t+"disable"),e.$overlay.off();var o=m("."+t+"modal-box",m(e.doc.body));o.animate({top:"-"+o.height()},100,function(){o.parent().remove(),e.hideOverlay()}),e.restoreRange()},openModalInsert:function(e,t,o){var s=this,r=s.o.prefix,i=s.lang,l="";return m.each(t,function(e,t){var o=t.label||e,n=t.name||e,a=t.attributes||{},e=Object.keys(a).map(function(e){return e+'="'+a[e]+'"'}).join(" ");l+='<label><input type="'+(t.type||"text")+'" name="'+n+'"'+("checkbox"===t.type&&t.value?' checked="checked"':' value="'+(t.value||"").replace(/"/g,"&quot;"))+'"'+e+'><span class="'+r+'input-infos"><span>'+(i[o]||o)+"</span></span></label>"}),s.openModal(e,l).on(d,function(){var a=m("form",m(this)),r=!0,i={};m.each(t,function(e,t){var o=t.name||e,n=m('input[name="'+o+'"]',a);switch(n.attr("type").toLowerCase()){case"checkbox":i[o]=n.is(":checked");break;case"radio":i[o]=n.filter(":checked").val();break;default:i[o]=m.trim(n.val())}t.required&&""===i[o]?(r=!1,s.addErrorOnModalField(n,s.lang.required)):t.pattern&&!t.pattern.test(i[o])&&(r=!1,s.addErrorOnModalField(n,t.patternError))}),r&&(s.restoreRange(),o(i,t)&&(s.syncCode(),s.$c.trigger("tbwchange"),s.closeModal(),m(this).off(d)))}).one(c,function(){m(this).off(d),s.closeModal()})},addErrorOnModalField:function(e,t){var o=this.o.prefix,n=o+"msg-error",a=e.parent();e.on("change keyup",function(){a.removeClass(o+"input-error"),setTimeout(function(){a.find("."+n).remove()},150)}),a.addClass(o+"input-error").find("input+span").append(m("<span/>",{class:n,text:t}))},getDefaultImgDblClickHandler:function(){var n=this;return function(){var t=m(this),e=t.attr("src"),o="(Base64)",e={url:{label:"URL",value:e=0===e.indexOf("data:image")?o:e,required:!0},alt:{label:n.lang.description,value:t.attr("alt")}};return n.o.imageWidthModalEdit&&(e.width={value:t.attr("width")?t.attr("width"):""}),n.openModalInsert(n.lang.insertImage,e,function(e){return e.url!==o&&t.attr({src:e.url}),t.attr({alt:e.alt}),n.o.imageWidthModalEdit&&(0<parseInt(e.width)?t.attr({width:e.width}):t.removeAttr("width")),!0}),!1}},saveRange:function(){var e,t=this,o=t.doc.getSelection();t.range=null,o&&o.rangeCount&&(e=t.range=o.getRangeAt(0),(o=t.doc.createRange()).selectNodeContents(t.$ed[0]),o.setEnd(e.startContainer,e.startOffset),t.metaRange={start:o=(o+"").length,end:o+(e+"").length})},restoreRange:function(){var e=this,t=e.metaRange,o=e.range,n=e.doc.getSelection();if(o){if(t&&t.start!==t.end)for(var a,r=0,i=[e.$ed[0]],s=!1,l=!1,d=e.doc.createRange();!l&&(a=i.pop());)if(3===a.nodeType){var c=r+a.length;!s&&t.start>=r&&t.start<=c&&(d.setStart(a,t.start-r),s=!0),s&&t.end>=r&&t.end<=c&&(d.setEnd(a,t.end-r),l=!0),r=c}else for(var u=a.childNodes,f=u.length;0<f;)i.push(u[--f]);try{n.removeAllRanges()}catch(e){}n.addRange(d||o)}},getRangeText:function(){return this.range+""},clearButtonPaneStatus:function(){var e=this.o.prefix,t=e+"active-button "+e+"active",o=e+"original-icon";m("."+e+"active-button",this.$btnPane).removeClass(t),m("."+o,this.$btnPane).each(function(){m(this).find("svg use").attr("xlink:href",m(this).data(o))})},updateButtonPaneStatus:function(){var s=this,l=s.o.prefix,d=l+"active-button "+l+"active",c=l+"original-icon",e=s.getTagsRecursive(s.doc.getSelection().focusNode);s.clearButtonPaneStatus(),m.each(e,function(e,t){var o=s.tagToButton[t.toLowerCase()];if(0<(t=m("."+l+o+"-button",s.$btnPane)).length)t.addClass(d);else try{var n=(t=m("."+l+"dropdown ."+l+o+"-dropdown-button",s.$box)).find("svg use"),a=t.parent().data(l+"dropdown"),r=m("."+l+a+"-button",s.$box),i=r.find("svg use");r.addClass(d),s.o.changeActiveDropdownIcon&&0<n.length&&(r.addClass(c).data(c,i.attr("xlink:href")),i.attr("xlink:href",n.attr("xlink:href")))}catch(e){}})},getTagsRecursive:function(o,n){var a=this;if(n=n||(o&&o.tagName?[o.tagName]:[]),!o||!o.parentNode)return n;var e=(o=o.parentNode).tagName;return"DIV"===e?n:("P"===e&&""!==o.style.textAlign&&n.push(o.style.textAlign),m.each(a.tagHandlers,function(e,t){n=n.concat(t(o,a))}),n.push(e),a.getTagsRecursive(o,n).filter(function(e){return null!=e}))},initPlugins:function(){var o=this;o.loadedPlugins=[],m.each(m.trumbowyg.plugins,function(e,t){t.shouldInit&&!t.shouldInit(o)||(t.init(o),t.tagHandler&&o.tagHandlers.push(t.tagHandler),o.loadedPlugins.push(t))})},destroyPlugins:function(){var o=this;m.each(this.loadedPlugins,function(e,t){t.destroy&&t.destroy(o)})}}}(navigator,window,document,jQuery),function(t){"use strict";t.extend(!0,t.trumbowyg,{langs:{en:{fontFamily:"Font"},es:{fontFamily:"Fuente"},da:{fontFamily:"Skrifttype"},fr:{fontFamily:"Police"},de:{fontFamily:"Schriftart"},nl:{fontFamily:"Lettertype"},tr:{fontFamily:"Yazı Tipi"},zh_tw:{fontFamily:"字體"},pt_br:{fontFamily:"Fonte"},ko:{fontFamily:"글꼴"}}});var a={fontList:[{name:"Arial",family:"Arial, Helvetica, sans-serif"},{name:"Arial Black",family:"'Arial Black', Gadget, sans-serif"},{name:"Comic Sans",family:"'Comic Sans MS', Textile, cursive, sans-serif"},{name:"Courier New",family:"'Courier New', Courier, monospace"},{name:"Georgia",family:"Georgia, serif"},{name:"Impact",family:"Impact, Charcoal, sans-serif"},{name:"Lucida Console",family:"'Lucida Console', Monaco, monospace"},{name:"Lucida Sans",family:"'Lucida Sans Uncide', 'Lucida Grande', sans-serif"},{name:"Palatino",family:"'Palatino Linotype', 'Book Antiqua', Palatino, serif"},{name:"Tahoma",family:"Tahoma, Geneva, sans-serif"},{name:"Times New Roman",family:"'Times New Roman', Times, serif"},{name:"Trebuchet",family:"'Trebuchet MS', Helvetica, sans-serif"},{name:"Verdana",family:"Verdana, Geneva, sans-serif"}]};t.extend(!0,t.trumbowyg,{plugins:{fontfamily:{init:function(e){var o,n;e.o.plugins.fontfamily=t.extend({},a,e.o.plugins.fontfamily||{}),e.addBtnDef("fontfamily",{dropdown:(o=e,n=[],t.each(o.o.plugins.fontfamily.fontList,function(e,t){o.addBtnDef("fontfamily_"+e,{title:'<span style="font-family: '+t.family+';">'+t.name+"</span>",hasIcon:!1,fn:function(){o.execCmd("fontName",t.family,!0)}}),n.push("fontfamily_"+e)}),n),hasIcon:!1,text:e.lang.fontFamily})}}}})}(jQuery),function(a){"use strict";a.extend(!0,a.trumbowyg,{langs:{en:{fontsize:"Font size",fontsizes:{"x-small":"Extra small",small:"Small",medium:"Regular",large:"Large","x-large":"Extra large",custom:"Custom"},fontCustomSize:{title:"Custom Font Size",label:"Font Size",value:"48"}},es:{fontsize:"Tamaño de Fuente",fontsizes:{"x-small":"Extra pequeña",small:"Pegueña",medium:"Regular",large:"Grande","x-large":"Extra Grande",custom:"Customizada"},fontCustomSize:{title:"Tamaño de Fuente Customizada",label:"Tamaño de Fuente",value:"48"}},da:{fontsize:"Skriftstørrelse",fontsizes:{"x-small":"Ekstra lille",small:"Lille",medium:"Normal",large:"Stor","x-large":"Ekstra stor",custom:"Brugerdefineret"}},fr:{fontsize:"Taille de la police",fontsizes:{"x-small":"Très petit",small:"Petit",medium:"Normal",large:"Grand","x-large":"Très grand",custom:"Taille personnalisée"},fontCustomSize:{title:"Taille de police personnalisée",label:"Taille de la police",value:"48"}},de:{fontsize:"Font size",fontsizes:{"x-small":"Sehr klein",small:"Klein",medium:"Normal",large:"Groß","x-large":"Sehr groß",custom:"Benutzerdefiniert"},fontCustomSize:{title:"Benutzerdefinierte Schriftgröße",label:"Schriftgröße",value:"48"}},nl:{fontsize:"Lettergrootte",fontsizes:{"x-small":"Extra klein",small:"Klein",medium:"Normaal",large:"Groot","x-large":"Extra groot",custom:"Tilpasset"}},tr:{fontsize:"Yazı Boyutu",fontsizes:{"x-small":"Çok Küçük",small:"Küçük",medium:"Normal",large:"Büyük","x-large":"Çok Büyük",custom:"Görenek"}},zh_tw:{fontsize:"字體大小",fontsizes:{"x-small":"最小",small:"小",medium:"中",large:"大","x-large":"最大",custom:"自訂大小"},fontCustomSize:{title:"自訂義字體大小",label:"字體大小",value:"48"}},pt_br:{fontsize:"Tamanho da fonte",fontsizes:{"x-small":"Extra pequeno",small:"Pequeno",regular:"Médio",large:"Grande","x-large":"Extra grande",custom:"Personalizado"},fontCustomSize:{title:"Tamanho de Fonte Personalizado",label:"Tamanho de Fonte",value:"48"}},it:{fontsize:"Dimensioni del testo",fontsizes:{"x-small":"Molto piccolo",small:"piccolo",regular:"normale",large:"grande","x-large":"Molto grande",custom:"Personalizzato"},fontCustomSize:{title:"Dimensioni del testo personalizzato",label:"Dimensioni del testo",value:"48"}},ko:{fontsize:"글꼴 크기",fontsizes:{"x-small":"아주 작게",small:"작게",medium:"보통",large:"크게","x-large":"아주 크게",custom:"사용자 지정"},fontCustomSize:{title:"사용자 지정 글꼴 크기",label:"글꼴 크기",value:"48"}}}});var t={sizeList:["x-small","small","medium","large","x-large"],allowCustomSize:!0};function u(e,n){a.each(e,function(e,t){try{var o;t.nodeType!==Node.TEXT_NODE?u(t.childNodes,n):((o=t.parentElement.style).fontSize=n,o.lineHeight="normal")}catch(e){}})}function i(e,t,o,n,a){if(void 0!==e)try{var r=t.previousSibling,i=0;try{for(;null!==r;)i+=r.textContent.length,r=r.previousSibling}catch(e){}n+=i;var s=e.innerText;if(!a&&0===n||a&&n===s.length)return void u([e],o);var l=s.substring(0,n),d=s.substring(n),c=e.cloneNode(!0);e.innerText=d,c.innerText=l,e.parentNode.insertBefore(c,e),u(a?[c]:[e],o)}catch(e){}}function r(e,t){e.saveRange();var o=t+"pt",n=e.range,a=[];!function t(o,n,e){e.childNodes.forEach(function(e){try{if(e.nodeType!==Node.TEXT_NODE)t(o,n,e);else{if(!o.intersectsNode(e))return;n.includes(e.parentNode)||"SPAN"!==e.parentNode.nodeName||n.push(e.parentNode)}}catch(e){}})}(n,a,n.commonAncestorContainer);var r=a.shift(),t=a.pop();i(r,n.startContainer,o,n.startOffset,!1),u(a,o),i(t,n.endContainer,o,n.endOffset,!0),e.saveRange()}a.extend(!0,a.trumbowyg,{plugins:{fontsize:{init:function(e){e.o.plugins.fontsize=a.extend({},t,e.o.plugins.fontsize||{}),e.addBtnDef("fontsize",{dropdown:function(o){var n=[];{var e,t;a.each(o.o.plugins.fontsize.sizeList,function(e,t){o.addBtnDef("fontsize_"+t,{text:'<span style="font-size: '+t+'pt;">'+(o.lang.fontsizes[t]||t)+"</span>",hasIcon:!1,fn:function(){return r(o,t),!0}}),n.push("fontsize_"+t)}),o.o.plugins.fontsize.allowCustomSize&&(e="fontsize_custom",t={fn:function(){o.openModalInsert(o.lang.fontCustomSize.title,{size:{label:o.lang.fontCustomSize.label,value:o.lang.fontCustomSize.value}},function(e){return r(o,e.size),!0})},text:'<span style="font-size: medium;">'+o.lang.fontsizes.custom+"</span>",hasIcon:!1},o.addBtnDef(e,t),n.push(e))}return n}(e)})}}}})}(jQuery),function(o){"use strict";function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}function r(e){return-1===e.search("rgb")?e.replace("#",""):"rgba(0, 0, 0, 0)"===e?"transparent":t((e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/))[1])+t(e[2])+t(e[3])}o.extend(!0,o.trumbowyg,{langs:{cs:{foreColor:"Barva textu",backColor:"Barva pozadí"},en:{foreColor:"Text color",backColor:"Background color",foreColorRemove:"Remove text color",backColorRemove:"Remove background color"},da:{foreColor:"Tekstfarve",backColor:"Baggrundsfarve"},fr:{foreColor:"Couleur du texte",backColor:"Couleur de fond",foreColorRemove:"Supprimer la couleur du texte",backColorRemove:"Supprimer la couleur de fond"},de:{foreColor:"Textfarbe",backColor:"Hintergrundfarbe"},nl:{foreColor:"Tekstkleur",backColor:"Achtergrondkleur"},sk:{foreColor:"Farba textu",backColor:"Farba pozadia"},zh_cn:{foreColor:"文字颜色",backColor:"背景颜色"},zh_tw:{foreColor:"文字顏色",backColor:"背景顏色"},ru:{foreColor:"Цвет текста",backColor:"Цвет выделения текста"},ja:{foreColor:"文字色",backColor:"背景色"},tr:{foreColor:"Yazı rengi",backColor:"Arkaplan rengi"},pt_br:{foreColor:"Cor de fonte",backColor:"Cor de fundo"},ko:{foreColor:"글자색",backColor:"배경색",foreColorRemove:"글자색 지우기",backColorRemove:"배경색 지우기"}}});var n={colorList:["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646","ffff00","f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada","fff2ca","d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5","ffe694","bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","b7dde8","fac08f","f2c314","a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","92cddc","e36c09","c09100","7f7f7f","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","31859b","974806","7f6000"],foreColorList:null,backColorList:null,allowCustomForeColor:!0,allowCustomBackColor:!0,displayAsList:!1};function a(a,r){var i=[],s=r.o.plugins.colors,e=s[a+"List"]||s.colorList;o.each(e,function(e,t){var o=a+t,n={fn:a,forceCss:!0,hasIcon:!1,text:r.lang["#"+t]||"#"+t,param:"#"+t,style:"background-color: #"+t+";"};s.displayAsList&&"foreColor"===a&&(n.style="color: #"+t+" !important;"),r.addBtnDef(o,n),i.push(o)});var t=a+"Remove",e={fn:"removeFormat",hasIcon:!1,param:a,style:"background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAG0lEQVQIW2NkQAAfEJMRmwBYhoGBYQtMBYoAADziAp0jtJTgAAAAAElFTkSuQmCC);"};return s.displayAsList&&(e.style=""),r.addBtnDef(t,e),i.push(t),s["allowCustom"+a.charAt(0).toUpperCase()+a.substr(1)]&&(e={fn:function(){r.openModalInsert(r.lang[a],{color:{label:a,forceCss:!0,type:"color",value:"#FFFFFF"}},function(e){return r.execCmd(a,e.color),!0})},hasIcon:!1,text:"#",style:"text-indent: 0; line-height: 20px; padding: 0 5px;"},r.addBtnDef(t=a+"Free",e),i.push(t)),i}o.extend(!0,o.trumbowyg,{plugins:{color:{init:function(e){e.o.plugins.colors=e.o.plugins.colors||n;var t=e.o.plugins.colors.displayAsList?e.o.prefix+"dropdown--color-list":"",o={dropdown:a("foreColor",e),dropdownClass:t},t={dropdown:a("backColor",e),dropdownClass:t};e.addBtnDef("foreColor",o),e.addBtnDef("backColor",t)},tagHandler:function(e,t){var o,n,a=[];return e.style&&(""!==e.style.backgroundColor&&(o=r(e.style.backgroundColor),0<=t.o.plugins.colors.colorList.indexOf(o)?a.push("backColor"+o):a.push("backColorFree")),""!==e.style.color?n=r(e.style.color):e.hasAttribute("color")&&(n=r(e.getAttribute("color"))),n&&(0<=t.o.plugins.colors.colorList.indexOf(n)?a.push("foreColor"+n):a.push("foreColorFree"))),a}}}})}(jQuery),function(i){"use strict";function t(){return"undefined"!=typeof FileReader}i.extend(!0,i.trumbowyg,{langs:{en:{base64:"Image as base64",file:"File",errFileReaderNotSupported:"FileReader is not supported by your browser.",errInvalidImage:"Invalid image file."},da:{base64:"Billede som base64",file:"Fil",errFileReaderNotSupported:"FileReader er ikke understøttet af din browser.",errInvalidImage:"Ugyldig billedfil."},fr:{base64:"Image en base64",file:"Fichier"},cs:{base64:"Vložit obrázek",file:"Soubor"},zh_cn:{base64:"图片（Base64编码）",file:"文件"},nl:{base64:"Afbeelding inline",file:"Bestand",errFileReaderNotSupported:"Uw browser ondersteunt deze functionaliteit niet.",errInvalidImage:"De gekozen afbeelding is ongeldig."},ru:{base64:"Изображение как код в base64",file:"Файл",errFileReaderNotSupported:"FileReader не поддерживается вашим браузером.",errInvalidImage:"Недопустимый файл изображения."},ja:{base64:"画像 (Base64形式)",file:"ファイル",errFileReaderNotSupported:"あなたのブラウザーはFileReaderをサポートしていません",errInvalidImage:"画像形式が正しくありません"},tr:{base64:"Base64 olarak resim",file:"Dosya",errFileReaderNotSupported:"FileReader tarayıcınız tarafından desteklenmiyor.",errInvalidImage:"Geçersiz resim dosyası."},zh_tw:{base64:"圖片(base64編碼)",file:"檔案",errFileReaderNotSupported:"你的瀏覽器不支援FileReader",errInvalidImage:"不正確的檔案格式"},pt_br:{base64:"Imagem em base64",file:"Arquivo",errFileReaderNotSupported:"FileReader não é suportado pelo seu navegador.",errInvalidImage:"Arquivo de imagem inválido."},ko:{base64:"그림 넣기(base64)",file:"파일",errFileReaderNotSupported:"FileReader가 현재 브라우저를 지원하지 않습니다.",errInvalidImage:"유효하지 않은 파일"}},plugins:{base64:{shouldInit:t,init:function(r){var e={isSupported:t,fn:function(){var n;r.saveRange();var a=r.openModalInsert(r.lang.base64,{file:{type:"file",required:!0,attributes:{accept:"image/*"}},alt:{label:"description",value:r.getRangeText()}},function(t){var o=new FileReader;o.onloadend=function(e){/^data:image\/[a-z]?/i.test(e.target.result)?(r.execCmd("insertImage",o.result,!1,!0),i(['img[src="',o.result,'"]:not([alt])'].join(""),r.$box).attr("alt",t.alt),r.closeModal()):r.addErrorOnModalField(i("input[type=file]",a),r.lang.errInvalidImage)},o.readAsDataURL(n)});i("input[type=file]").on("change",function(e){n=e.target.files[0]})}};r.addBtnDef("base64",e)}}}})}(jQuery),function(t){"use strict";var o={minSize:32,step:4};function n(e){return e.preventDefault()}function a(e){e.$ed.find("img.resizable").resizable("destroy").off("mousedown",n).removeClass("resizable"),e.syncTextarea()}t.extend(!0,t.trumbowyg,{plugins:{resizimg:{init:function(r){function e(){r.$ed.find("img:not(.resizable)").resizable(r.o.plugins.resizimg.resizable).on("mousedown",n)}r.o.plugins.resizimg=t.extend(!0,{},o,r.o.plugins.resizimg||{},{resizable:{resizeWidth:!1,onDragStart:function(e,t){"auto"!==t.css("width")&&t.css("width","auto")},onDrag:function(e,t,o,n){var a=r.o.plugins.resizimg;return n<a.minSize&&(n=a.minSize),n-=n%a.step,t.height(n),!1},onDragEnd:function(){r.syncCode()}}}),r.$c.on("tbwinit",e),r.$c.on("tbwfocus",e),r.$c.on("tbwchange",e),r.$c.on("tbwblur",function(){a(r)}),r.$c.on("tbwclose",function(){a(r)})},destroy:function(e){a(e)}}}})}(jQuery),function(f){"use strict";f.extend(!0,f.trumbowyg,{langs:{de:{history:{redo:"Wiederholen",undo:"Rückgängig"}},en:{history:{redo:"Redo",undo:"Undo"}},da:{history:{redo:"Annuller fortryd",undo:"Fortryd"}},fr:{history:{redo:"Annuler",undo:"Rétablir"}},zh_tw:{history:{redo:"重做",undo:"復原"}},pt_br:{history:{redo:"Refazer",undo:"Desfazer"}},ko:{history:{redo:"다시 실행",undo:"되돌리기"}}},plugins:{history:{init:function(d){d.o.plugins.history=f.extend(!0,{_stack:[],_index:-1,_focusEl:void 0},d.o.plugins.history||{});var e={title:d.lang.history.redo,ico:"redo",key:"Y",fn:function(){var e,t;d.o.plugins.history._index<d.o.plugins.history._stack.length-1&&(d.o.plugins.history._index+=1,e=d.o.plugins.history._index,t=d.o.plugins.history._stack[e],d.execCmd("html",t),d.o.plugins.history._stack[e]=d.$ed.html(),n(),c())}},t={title:d.lang.history.undo,ico:"undo",key:"Z",fn:function(){var e,t;0<d.o.plugins.history._index&&(--d.o.plugins.history._index,e=d.o.plugins.history._index,t=d.o.plugins.history._stack[e],d.execCmd("html",t),d.o.plugins.history._stack[e]=d.$ed.html(),n(),c())}},c=function(){var e=d.o.plugins.history._index,t=d.o.plugins.history._stack.length,t=0!==t&&e!==t-1;o("historyUndo",0<e),o("historyRedo",t)},o=function(e,t){e=d.$box.find(".trumbowyg-"+e+"-button");t?e.removeClass("trumbowyg-disable"):e.hasClass("trumbowyg-disable")||e.addClass("trumbowyg-disable")},u=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var o=0;o<e.length;o+=1)if(e[o]!==t[o])return!1;return!0},n=function(){var e=d.doc.getSelection().focusNode,t=d.doc.createRange();0<e.childNodes.length&&(t.setStartAfter(e.childNodes[e.childNodes.length-1]),t.setEndAfter(e.childNodes[e.childNodes.length-1]),d.doc.getSelection().removeAllRanges(),d.doc.getSelection().addRange(t))};d.$c.on("tbwinit tbwchange",function(){var e=d.o.plugins.history._index,t=d.o.plugins.history._stack,o=t.slice(-1)[0]||"<p></p>",n=t[e],a=d.$ed.html(),r=d.doc.getSelection().focusNode,i="",s=d.o.plugins.history._focusEl,l=f("<div>"+o+"</div>").find("*").map(function(){return this.localName}),o=f("<div>"+a+"</div>").find("*").map(function(){return this.localName});r&&(i=(d.o.plugins.history._focusEl=r).outerHTML||r.textContent),a!==n&&(i.slice(-1).match(/\s/)||!u(l,o)||d.o.plugins.history._index<=0||r!==s?(d.o.plugins.history._index+=1,d.o.plugins.history._stack=t.slice(0,d.o.plugins.history._index),d.o.plugins.history._stack.push(a)):d.o.plugins.history._stack[e]=a,c())}),d.addBtnDef("historyRedo",e),d.addBtnDef("historyUndo",t)}}}})}(jQuery),function(e){"use strict";e.extend(!0,e.trumbowyg,{plugins:{pasteImage:{init:function(r){r.pasteHandlers.push(function(e){try{for(var t,o=(e.originalEvent||e).clipboardData.items,n=!1,a=o.length-1;0<=a;--a)o[a].type.match(/^image\//)&&((t=new FileReader).onloadend=function(e){r.execCmd("insertImage",e.target.result,!1,!0)},t.readAsDataURL(o[a].getAsFile()),n=!0);n&&(e.stopPropagation(),e.preventDefault())}catch(e){}})}}}})}(jQuery),window.fbAsyncInit=function(){FB.init({appId:"813346076044703",autoLogAppEvents:!0,xfbml:!0,version:"v11.0"})};const NPS_STORAGE_KEY="nps-score",NPS_STEP_COUNT=6;let formParameters={},npsStep=1,npsGrade={appname:"",score:null,fileId:null,message:"",message2:"",email:"",additional:"",formparameters:{},referer:document.location.pathname};const sendNpsScore=(n=5,a=!1)=>{if(null!==npsGrade.score||npsGrade.message||npsGrade.message2||npsGrade.email){let t;try{if(t=JSON.parse(window.localStorage.getItem(NPS_STORAGE_KEY)),!t)throw new Exception}catch(e){t={}}t[o.AppName]=npsGrade.score,window.localStorage.setItem(NPS_STORAGE_KEY,JSON.stringify(t)),npsGrade.appname=o.AppName,npsGrade.formparameters=JSON.stringify(formParameters);let e="undefined"!=typeof fileDrop&&$("#nps-attach-files").prop("checked")?fileDrop.prepareFormData():null;e=e||new FormData;for(const r in npsGrade)e.set(r,npsGrade[r]);"Viewer"===o.AppName&&$("#nps-attach-files").prop("checked")&&e.set("fileId",documentGuid),showNpsPreloader(),$.ajax({method:"POST",url:o.APIBasePath+"feedback",data:e,processData:!1,contentType:!1,cache:!1,success:()=>{hideNpsPreloader();for(let e=1;e<=NPS_STEP_COUNT;e++)$(`.nps-container > #nps-step-${e}`).css("display",e===n?"flex":"none");a||window.setTimeout(()=>{closeNps()},3e3)},error:e=>{closeNps()}})}else closeNps()},startNpsSurvey=()=>{$(".nps-container").css("display","flex"),npsShow(null)},setNpsScore=e=>{$(".nps-score").each(function(){$(this).hasClass(`nps-score-${e}`)?$(this).addClass("selected"):$(this).hasClass("selected")&&$(this).removeClass("selected")}),null!=(npsGrade.score=e)&&gaEventSocial(e,"NPS"),NpsStep(1)},NpsStep=(e,t=!1)=>{switch(e){case 1:if(!t){var n;null!==npsGrade.score&&(7<=npsGrade.score?(sendNpsScore(6,!0),$(".nps-step").each(function(){"nps-step-6"===$(this).attr("id")?$(this).css("display","flex"):$(this).css("display","none")})):(npsStep=2,n=$("#nps-score-reason").html().replace("%appName%",o.AppName).replace("%appScore%",npsGrade.score),$("#current-nps-score").text(n),$(".nps-step").each(function(){"nps-step-2"===$(this).attr("id")?$(this).css("display","flex"):$(this).css("display","none")})));break}npsGrade.score=null;break;case 2:npsStep=3,t||(npsGrade.message=$("#nps-message").val()),$(".nps-step").each(function(){"nps-step-3"===$(this).attr("id")?$(this).css("display","flex"):$(this).css("display","none")});break;case 3:npsStep=4,t||(npsGrade.message2=$("#nps-message-2").val()),"undefined"==typeof fileDrop&&"Viewer"!==o.AppName?$("#nps-step-4 > .form-check").hide():npsGrade.score<7&&null!==npsGrade.score?$("#nps-attach-files").prop("checked",!0):$("#nps-attach-files").prop("checked",!1),$(".nps-step").each(function(){"nps-step-4"===$(this).attr("id")?$(this).css("display","flex"):$(this).css("display","none")});break;case 4:sendNpsScore();break;case 5:$(".nps-step").each(function(){"nps-step-6"===$(this).attr("id")?$(this).css("display","flex"):$(this).css("display","none")})}},closeNps=()=>{$(".nps-container").css("display","none")},showNpsPreloader=()=>{$(".nps-preloader").css("display","flex")},hideNpsPreloader=()=>{$(".nps-preloader").css("display","none")},npsShow=(e=void 0)=>{let t,n=!1;var a=void 0!==e;try{if(t=JSON.parse(window.localStorage.getItem(NPS_STORAGE_KEY)),!t)throw new Exception;t[o.AppName]||(n=!0)}catch(e){n=!0,t={}}if($(".nps-preloader").css("display","none"),a||!t[o.AppName]){$("#select-nps-score").text($("#nps-will-recommend").html().replace("%appName%",o.AppName));for(let e=1;e<=NPS_STEP_COUNT;e++)$(`.nps-container > #nps-step-${e}`).css("display",1===e?"flex":"none");(a||n)&&($(".nps-container").css("display","flex"),$(".nps-button").css("display","none")),a&&null!==e&&gaEventSocial("Feedback","Download",e)}else $(".nps-button").css("display","flex")};let trum=null,t=null,loading=!1,filename="";function showLoader(){$("#page-loading").show(),$("#loader").show()}function hideLoader(){$("#page-loading").fadeOut(600),$("#htmlloader").hide()}function showError(e){$("#alert > p")[0].innerText=e,$("#alert").show()}function errorProcessText(e){if(void 0!==e.data&&void 0!==e.data.status)return e.data.status;if(void 0!==e.responseJSON&&void 0!==e.responseJSON.errors[""])return"Error "+e.status+": "+e.responseJSON.errors[""];if(500===e.status&&void 0!==e.responseText){var t=JSON.parse(e.responseText);if(void 0!==t&&null!=t&&void 0!==t.message)return t.message}return void 0!==e.responseText?"Error "+e.status+": "+e.responseText:"Error "+e.status+": "+e.statusText}function getEditorHtml(){let e=new URLSearchParams(window.location.search);var t={id:e.get("id")};$.ajax({method:"POST",url:o.UIBasePath+"getHtml",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",cache:!1,timeout:6e5,success:e=>{filename=e.filename,trum.trumbowyg("html",e.data)},error:e=>{showError(errorProcessText(e)),trum.trumbowyg("html","")},complete:()=>{hideLoader()}})}function download(e){showLoader();let t=new URLSearchParams(window.location.search);var n="<!DOCTYPE html><html><head>"+(n=trum.trumbowyg("html").replace("</title>","</title></head><body>").replace(/-aw-import:ignore/gi,""))+"</body></html>",e={filename:filename,html:n,outputType:e,id:t.get("id")};$.ajax({method:"POST",url:o.UIBasePath+"save",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",cache:!1,timeout:6e5,success:e=>{downloadFile(o.UIBasePath+"Download?id="+encodeURIComponent(e.id),e.name)},error:e=>{showError(errorProcessText(e)),trum.trumbowyg("html","")},complete:()=>{hideLoader()}})}function downloadFile(e,t){const o=document.createElement("a");o.download=t,o.href=e,o.style.display="none",document.body.append(o),o.click(),setTimeout(()=>{o.remove()},100)}function closeWindow(){window.parent&&window.parent.closeIframe&&(window.history.back(),window.parent.closeIframe())}$(document).ready(function(){trum=$("#editor"),trum.trumbowyg({autogrow:!0,fixedBtnPane:!0,minimalLinks:!0,urlProtocol:!0,prefix:"editoraspose-",svgPath:"/words/common/img/icons/editor-icons.svg",btnsDef:{image:{dropdown:["insertImage","base64"],ico:"insertImage"},togglePreview:{fn:function(){$scope.TogglePreview()},tag:"toggle_preview",title:"Toggle editor/preview mode",text:"Preview",hasIcon:!1,isSupported:function(){return $scope.allowPreview}}},btns:[["historyUndo","historyRedo"],["formatting"],["fontfamily"],["fontsize"],["strong","em","underline"],["foreColor","backColor"],["superscript","subscript"],["link"],["image"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["horizontalRule"],["fullscreen"]],plugins:{fontfamily:{fontList:[{name:"Arial",family:"Arial, Helvetica, sans-serif"},{name:"Arial Black",family:"'Arial Black', Gadget, sans-serif"},{name:"Comic Sans",family:"'Comic Sans MS', Textile, cursive, sans-serif"},{name:"Courier New",family:"'Courier New', Courier, monospace"},{name:"Georgia",family:"Georgia, serif"},{name:"Impact",family:"Impact, Charcoal, sans-serif"},{name:"Lucida Console",family:"'Lucida Console', Monaco, monospace"},{name:"Lucida Sans",family:"'Lucida Sans Uncide', 'Lucida Grande', sans-serif"},{name:"Palatino",family:"'Palatino Linotype', 'Book Antiqua', Palatino, serif"},{name:"Tahoma",family:"Tahoma, Geneva, sans-serif"},{name:"Times New Roman",family:"'Times New Roman', Times, serif"},{name:"Trebuchet",family:"'Trebuchet MS', Helvetica, sans-serif"},{name:"Verdana",family:"Verdana, Geneva, sans-serif"}]},fontsize:{sizeList:["9","14","18","22","30"],allowCustomSize:!0}}}),$(".download-item").click(function(){download($(this).attr("data-ext"))}),trum.trumbowyg("html",""),t=trum.data("trumbowyg"),getEditorHtml()});